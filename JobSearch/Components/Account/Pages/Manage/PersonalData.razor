@page "/Account/Manage/PersonalData"
@using JobSearch.Data

@inject IdentityUserAccessor UserAccessor

<PageTitle>Dane Osobowe</PageTitle>

<div class="security-container">
    <h2 class="page-title">Dane Osobowe</h2>
    <p class="page-subtitle">Zarządzanie Twoimi danymi (GDPR).</p>

    <StatusMessage />

    <div class="security-card data-card">

        <div class="data-intro-section">
            <p class="intro-text">Twoje konto zawiera dane osobowe, które nam przekazałeś. Ta strona umożliwia ich pobranie lub trwałe usunięcie.</p>
        </div>

        <div class="delete-warning-box">
            <p>
                <i class="bi bi-shield-lock-fill me-2"></i>
                <strong>Usunięcie tych danych spowoduje trwałe usunięcie Twojego konta. Tego procesu nie można cofnąć!</strong>
            </p>
        </div>

        <div class="data-actions-group">

            <form action="Account/Manage/DownloadPersonalData" method="post">
                <AntiforgeryToken />
                <button class="btn-security-action wide-button" type="submit">
                    <i class="bi bi-download me-2"></i> Pobierz dane
                </button>
            </form>

            <p class="or-separator">lub</p>

            <a href="Account/Manage/DeletePersonalData" class="btn-security-danger wide-button">
                <i class="bi bi-trash-fill me-2"></i> Usuń konto i dane
            </a>

        </div>
    </div>
</div>

@code {
    [CascadingParameter]
    private HttpContext HttpContext { get; set; } = default!;

    protected override async Task OnInitializedAsync()
    {
        _ = await UserAccessor.GetRequiredUserAsync(HttpContext);
    }
}